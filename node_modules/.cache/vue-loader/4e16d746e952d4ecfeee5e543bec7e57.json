{"remainingRequest":"D:\\project\\dapp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\dapp\\src\\views\\shopDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\dapp\\src\\views\\shopDetail.vue","mtime":1652681606262},{"path":"D:\\project\\dapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650249328532},{"path":"D:\\project\\dapp\\node_modules\\thread-loader\\dist\\cjs.js","mtime":1650249327231},{"path":"D:\\project\\dapp\\node_modules\\babel-loader\\lib\\index.js","mtime":1650249335774},{"path":"D:\\project\\dapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650249328532},{"path":"D:\\project\\dapp\\node_modules\\vue-loader\\lib\\index.js","mtime":1650249334419}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport Vue from 'vue'\nimport Abi from '../json/Abi.js'\nimport BigNumber from \"bignumber.js\"\nimport {\n\tCollapse,\n\tCollapseItem,\n\tCell,\n\tCol,\n\tRow,\n\tNavBar,\n\tList,\n\tLoading\n} from 'vant'\nVue.use(Collapse).use(CollapseItem).use(Cell).use(Col).use(Row).use(NavBar).use(List).use(Loading)\nimport {\n\tlistLog,\n\tgetNft,\n} from \"../api\";\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tactiveNames: [0],\n\t\t\tdatalist: [],\n\t\t\tdetaillist: [],\n\t\t\tcopyIds:'',\n\t\t\tpage: 1,\n\t\t\tnum: 10,\n\t\t\tloading: false,\n\t\t\tfinished: false,\n\t\t\tpageLoading:false,\n\t\t\tmyaddress:sessionStorage.getItem('myAddress'),\n\t\t\tispage:''\n\t\t}\n\t},\n\tmounted() {\n\t\t//sessionStorage.setItem('shopdelpage', 'shopdelpage')\n\t\tthis.detailNft(this.$route.query.userId)\n\t\tthis.ispage = this.$route.query.ispage\n\t},\n\tmethods: {\n\t\tbackup(){\n\t\t\tif(this.ispage=='me'){\n\t\t\t\tthis.$router.push({\n\t\t\t\t\tname: 'me',\n\t\t\t\t\tispage:'me'\n\t\t\t\t})\n\t\t\t}else if(this.ispage=='home'){\n\t\t\t\tthis.$router.push({\n\t\t\t\t\tname: 'Home',\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\tthis.$router.back()\n\t\t\t}\n\t\t},\n\t\tonMore() {\t\n\t\t\tif(this.detaillist!=''){\n\t\t\t\tthis.page++\n\t\t\t\tthis.loglist()\n\t\t\t}\n\t\t},\n\t\tcopyclick(txt) {\n\t\t\tconsole.log(txt)\n\t\t\tthis.$copyText(txt).then(() => {\n\t\t\t\tthis.$toast('Successfully copied to clipboard')\n\t\t\t}).catch(() => {\n\t\t\t\tthis.$toast('Copy failed')\n\t\t\t})\n\t\t},\n\t\t//跳转他人地址\n\t\tgootheraddress(address) {\n\t\t\tif(address==this.myaddress){\n\t\t\t\tthis.$router.push({\n\t\t\t\t\tname: 'me',\n\t\t\t\t\tquery: {\n\t\t\t\t\t\taddress: address,\n\t\t\t\t\t\tispage:'shopdeil'\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}else{\n\t\t\t\tthis.$router.push({\n\t\t\t\t\tname: 'otherList',\n\t\t\t\t\tquery: {\n\t\t\t\t\t\taddress: address\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t}\n\t\t\t\n\t\t},\n\t\t//购买\n\t\tbuyClick() {\n\t\t\tif (window.ethereum) {\n\t\t\t\twindow.ethereum.enable().then((res) => {\n\t\t\t\t\tif (!res[0]) {\n\t\t\t\t\t\tthis.$toast('Please log in to little fox first')\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconst web3 = new this.Web3(window.web3.currentProvider)\n\t\t\t\t\t\t//合约地址测试\n\t\t\t\t\t\tconst address = \"0x1A3B441D42F733fbC55774456D62081CAd462c3C\"\n\t\t\t\t\t\t//正式\n\t\t\t\t\t\t//const address = \"0xAcD1fD491Eb468f93209F2e63cCFdc9926af7731\"\n\t\t\t\t\t\tconst myContract = new web3.eth.Contract(Abi, address)\n\t\t\t\t\t\tmyContract.methods.getOffShelfTime(this.detaillist.contract,this.detaillist.tokenId).call().then(\n\t\t\t\t\t\ttimesTamp => {\n\t\t\t\t\t\t\t//获取当前时间戳单位毫秒\n\t\t\t\t\t\t\tvar dataTime = new Date().getTime()\n\t\t\t\t\t\t\t//当前时间戳与上架时间（秒）相比\n\t\t\t\t\t\t\tconsole.log('from timesTamp :' + timesTamp, dataTime)\n\t\t\t\t\t\t\tif (timesTamp * 1000 - dataTime > 0) {\n\t\t\t\t\t\t\t\tconsole.log(timesTamp * 1000 - dataTime)\n\t\t\t\t\t\t\t\t//商品未下架获取商品价格\n\t\t\t\t\t\t\t\t//NFT上架价格\n\t\t\t\t\t\t\t\tmyContract.methods.getPrices(this.detaillist.contract,this.detaillist.tokenId).call().then(\n\t\t\t\t\t\t\t\t\tprices => {\n\t\t\t\t\t\t\t\t\t\tconsole.log('from prices :' + prices)\n\t\t\t\t\t\t\t\t\t\tvar myvalue = BigNumber(prices)\n\t\t\t\t\t\t\t\t\t\tthis.pageLoading = true\n\t\t\t\t\t\t\t\t\t\t//var myvalue = BigNumber(web3.utils.toWei(this.detaillist.price.toString(), 'ether'))\n\t\t\t\t\t\t\t\t\t\t//购买NFT 获取是否授权（授权在上架商品时操作只需操作一次 获取时间戳 获取价格 \n\t\t\t\t\t\t\t\t\t\tmyContract.methods.buy(this.detaillist.contract,this.detaillist.tokenId).send({\n\t\t\t\t\t\t\t\t\t\t\tfrom: res[0],\n\t\t\t\t\t\t\t\t\t\t\tvalue: myvalue//动态获取商品价格\n\t\t\t\t\t\t\t\t\t\t}).then(res => {\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('from res :' + res)\n\t\t\t\t\t\t\t\t\t\t\tif (JSON.stringify(res.status) == 'true') {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$toast('Authorization succeeded')\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"success\")\n\t\t\t\t\t\t\t\t\t\t\t\t//刷新页面\n\t\t\t\t\t\t\t\t\t\t\t\t//location.reload()\n\t\t\t\t\t\t\t\t\t\t\t\tthis.pageLoading = false\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$router.push('me') \n\t\t\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$toast(res.message)\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res.message)\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}).catch((error) => {\n\t\t\t\t\t\t\t\t\t\t\tthis.pageLoading = false\n\t\t\t\t\t\t\t\t\t\t\t//this.$toast(error.message)\n\t\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tconsole.log(timesTamp * 1000 - dataTime)\n\t\t\t\t\t\t\t\tthis.$toast('The product has been taken off the shelf')\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t})\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t} else {\n\t\t\t\tthis.$toast('Please install metamask before the browser can be used.');\n\t\t\t}\n\t\t},\n\t\tdetailNft(userId) {\n\t\t\tconst params = {\n\t\t\t\tid: userId,\n\t\t\t}\n\t\t\tgetNft(params).then(res => {\n\t\t\t\tif (res.code == \"200\") {\n\t\t\t\t\tthis.detaillist = res.result\n\t\t\t\t\tthis.copyIds = res.result.tokenId\n\t\t\t\t\tthis.loglist()\n\t\t\t\t} else {\n\t\t\t\t\tthis.$toast(res.message)\n\t\t\t\t}\n\t\t\t})\n\t\t},\n\t\tloglist() {\n\t\t\tconst params = {\n\t\t\t\tpageNo: this.page,\n\t\t\t\tpageSize: this.num,\n\t\t\t\ttokenId: this.detaillist.tokenId,\n\t\t\t\tcontract: this.detaillist.contract,\n\t\t\t}\n\t\t\tlistLog(params).then(res => {\n\t\t\t\tif (res.code == \"200\") {\n\t\t\t\t\tif (this.page == 1) {\n\t\t\t\t\t\tthis.datalist = res.result.list\n\t\t\t\t\t}else{\n\t\t\t\t\t\tthis.datalist = this.datalist.concat(res.result.list)\n\t\t\t\t\t}\n\t\t\t\t\tthis.loading = false\n\t\t\t\t\tif (res.result.list.length == 0 || res.result.list.length < 10) {\n\t\t\t\t\t\tthis.finished = true\n\t\t\t\t\t\treturn\n\t\t\t\t\t}\t\n\t\t\t\t} else {\n\t\t\t\t\tthis.$toast(res.message)\n\t\t\t\t}\n\t\t\t})\n\t\t}\n\t},\n}\n",{"version":3,"sources":["shopDetail.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAuFA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"shopDetail.vue","sourceRoot":"src/views","sourcesContent":["<template>\r\n\t<div class=\"wrap\">\r\n\t\t<div class=\"headerbox\">\r\n\t\t<van-nav-bar title=\"NFT details\" left-arrow @click-left=\"backup\" />\r\n\t\t</div>\r\n\t\t<div class=\"contentone\">\r\n\t\t\t<div class=\"onecell\"><span class=\"onecelll\">Minted by</span><span\r\n\t\t\t\t\t@click=\"gootheraddress(detaillist.creator)\"\r\n\t\t\t\t\tclass=\"onecellr\">{{detaillist.creator==null?'creator':detaillist.creator | ellipsis}}</span></div>\r\n\t\t\t<div class=\"twocell\"><span class=\"twocelll\">{{detaillist.name==null?'name':detaillist.name}}</span>\r\n\t\t\t<!-- <span class=\"twocellr\">#{{detaillist.tokenId}}</span> -->\r\n\t\t\t</div>\r\n\t\t\t<div class=\"threecell\">\r\n\t\t\t\t<img v-if=\"detaillist.image==null\" src=\"../assets/images/zw.png\" />\r\n\t\t\t\t<img v-else :src=\"detaillist.image\" />\r\n\t\t\t</div>\r\n\t\t\t<div class=\"fourcell\">\r\n\t\t\t\t<div class=\"fourcelll\">\r\n\t\t\t\t\t<span class=\"fourcellone\">Owned by</span>\r\n\t\t\t\t\t<span class=\"fourcelltwo\"\r\n\t\t\t\t\t\t@click=\"gootheraddress(detaillist.owner)\">{{detaillist.owner==null?'detaillistowner':detaillist.owner | ellipsis}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"fourcellr\">End date{{detaillist.offSheftTime!=null?detaillist.offSheftTime.substring(0,16):''}}</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"contenttwo\">\r\n\t\t\t<div class=\"contenttwoo\">Current price</div>\r\n\t\t\t<div class=\"contenttwot\">\r\n\t\t\t\t<div class=\"contenttwotl\">\r\n\t\t\t\t\t<span><img src=\"../assets/images/icon1.png\"></span>\r\n\t\t\t\t\t<span class=\"spantwo\">{{detaillist.price==null?'0.00':detaillist.price}}</span>\r\n\t\t\t\t\t<span v-if=\"detaillist.uprice!=null\" class=\"spanthree\">{{`（$${detaillist.uprice==null?'':detaillist.uprice}）`}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div v-if=\"detaillist.owner != myaddress\" class=\"contenttwotr\" @click=\"buyClick\" v-throttle=\"3000\">Buy now</div>\r\n\t\t\t\t<div v-else class=\"contenttwotrn\">Buy now</div>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<van-collapse v-model=\"activeNames\">\r\n\t\t\t\t\t<van-collapse-item title=\"Introduction to the works\" name=\"0\" icon=\"smile-comment-o\" class='mycell'>\r\n\t\t\t\t\t\t<div class=\"descriptionbox\">{{detaillist.description==''?'No details yet':detaillist.description}}</div>\r\n\t\t\t\t\t</van-collapse-item>\r\n\t\t\t\t\t<van-collapse-item title=\"Details of the works\" name=\"1\" icon=\"coupon-o\" class='mycell'>\r\n\t\t\t\t\t\t<van-cell title=\"Contract address\">\r\n\t\t\t\t\t\t\t<template #right-icon>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\tclass=\"copyadd\">{{detaillist.contract==null?'detaillistcontract':detaillist.contract | ellipsis }}</span>\r\n\t\t\t\t\t\t\t\t<img class=\"copyimg\" @click=\"copyclick(detaillist.contract)\" src=\"../assets/images/copy.png\">\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</van-cell>\r\n\t\t\t\t\t\t<van-cell title=\"Token ID\">\r\n\t\t\t\t\t\t\t<template #right-icon>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\tclass=\"copyadd\">{{detaillist.tokenId==null?'detaillisttokenId':detaillist.tokenId | ellipsis }}</span>\r\n\t\t\t\t\t\t\t\t<img class=\"copyimg\" @click=\"copyclick(copyIds)\" src=\"../assets/images/copy.png\">\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</van-cell>\r\n\t\t\t\t\t\t<van-cell title=\"Token standard\" value=\"ERC-721\" />\r\n\t\t\t\t\t\t<van-cell title=\"Blockchain\" value=\"BNB\" />\r\n\t\t\t\t\t</van-collapse-item>\r\n\t\t\t\t\t<van-list v-model:loading=\"loading\" :finished=\"finished\" @load=\"onMore\" loading-text=\"Loading\">\r\n\t\t\t\t\t\t<van-collapse-item title=\"Price history\" name=\"2\" icon=\"todo-list-o\" class='mycell'>\r\n\t\t\t\t\t\t\t<van-row justify=\"space-between\">\r\n\t\t\t\t\t\t\t\t<van-col span=\"6\">Current price</van-col>\r\n\t\t\t\t\t\t\t\t<van-col span=\"6\">From</van-col>\r\n\t\t\t\t\t\t\t\t<van-col span=\"6\">To</van-col>\r\n\t\t\t\t\t\t\t\t<van-col span=\"6\">Date</van-col>\r\n\t\t\t\t\t\t\t</van-row>\r\n\t\t\t\t\t\t\t<div v-if=\"datalist.length==0\" class=\"nodata\">No deal</div>\r\n\t\t\t\t\t\t\t<div v-else class=\"hasdata\">\r\n\t\t\t\t\t\t\t<van-row justify=\"space-between\" v-for=\"(item,index) in datalist\" :key='index'>\r\n\t\t\t\t\t\t\t\t\t<van-col span=\"6\">{{item.price}}</van-col>\r\n\t\t\t\t\t\t\t\t\t<van-col span=\"6\"><span class=\"addurl\"\r\n\t\t\t\t\t\t\t\t\t\t\t@click=\"gootheraddress(item.buyFrom)\">{{item.buyFrom | ellipsis}}</span></van-col>\r\n\t\t\t\t\t\t\t\t\t<van-col span=\"6\"><span class=\"addurl\"\r\n\t\t\t\t\t\t\t\t\t\t\t@click=\"gootheraddress(item.buyTo)\">{{item.buyTo | ellipsis}}</span></van-col>\r\n\t\t\t\t\t\t\t\t\t<van-col span=\"6\">{{item.createTime.substring(0, item.createTime.indexOf(' '))}}</van-col>\r\n\t\t\t\t\t\t\t</van-row>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</van-collapse-item>\r\n\t\t\t\t\t</van-list>\r\n\t\t\t\t</van-collapse>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t<van-loading v-show=\"pageLoading\" type=\"spinner\" size=\"24px\" class=\"loadingbox\" van-loading  color=\"#0094ff\"/>\r\n\t</div>\r\n</template>\r\n<script>\r\n\timport Vue from 'vue'\r\n\timport Abi from '../json/Abi.js'\r\n\timport BigNumber from \"bignumber.js\"\r\n\timport {\r\n\t\tCollapse,\r\n\t\tCollapseItem,\r\n\t\tCell,\r\n\t\tCol,\r\n\t\tRow,\r\n\t\tNavBar,\r\n\t\tList,\r\n\t\tLoading\r\n\t} from 'vant'\r\n\tVue.use(Collapse).use(CollapseItem).use(Cell).use(Col).use(Row).use(NavBar).use(List).use(Loading)\r\n\timport {\r\n\t\tlistLog,\r\n\t\tgetNft,\r\n\t} from \"../api\";\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tactiveNames: [0],\r\n\t\t\t\tdatalist: [],\r\n\t\t\t\tdetaillist: [],\r\n\t\t\t\tcopyIds:'',\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tnum: 10,\r\n\t\t\t\tloading: false,\r\n\t\t\t\tfinished: false,\r\n\t\t\t\tpageLoading:false,\r\n\t\t\t\tmyaddress:sessionStorage.getItem('myAddress'),\r\n\t\t\t\tispage:''\r\n\t\t\t}\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\t//sessionStorage.setItem('shopdelpage', 'shopdelpage')\r\n\t\t\tthis.detailNft(this.$route.query.userId)\r\n\t\t\tthis.ispage = this.$route.query.ispage\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tbackup(){\r\n\t\t\t\tif(this.ispage=='me'){\r\n\t\t\t\t\tthis.$router.push({\r\n\t\t\t\t\t\tname: 'me',\r\n\t\t\t\t\t\tispage:'me'\r\n\t\t\t\t\t})\r\n\t\t\t\t}else if(this.ispage=='home'){\r\n\t\t\t\t\tthis.$router.push({\r\n\t\t\t\t\t\tname: 'Home',\r\n\t\t\t\t\t})\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.$router.back()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tonMore() {\t\r\n\t\t\t\tif(this.detaillist!=''){\r\n\t\t\t\t\tthis.page++\r\n\t\t\t\t\tthis.loglist()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcopyclick(txt) {\r\n\t\t\t\tconsole.log(txt)\r\n\t\t\t\tthis.$copyText(txt).then(() => {\r\n\t\t\t\t\tthis.$toast('Successfully copied to clipboard')\r\n\t\t\t\t}).catch(() => {\r\n\t\t\t\t\tthis.$toast('Copy failed')\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//跳转他人地址\r\n\t\t\tgootheraddress(address) {\r\n\t\t\t\tif(address==this.myaddress){\r\n\t\t\t\t\tthis.$router.push({\r\n\t\t\t\t\t\tname: 'me',\r\n\t\t\t\t\t\tquery: {\r\n\t\t\t\t\t\t\taddress: address,\r\n\t\t\t\t\t\t\tispage:'shopdeil'\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.$router.push({\r\n\t\t\t\t\t\tname: 'otherList',\r\n\t\t\t\t\t\tquery: {\r\n\t\t\t\t\t\t\taddress: address\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t//购买\r\n\t\t\tbuyClick() {\r\n\t\t\t\tif (window.ethereum) {\r\n\t\t\t\t\twindow.ethereum.enable().then((res) => {\r\n\t\t\t\t\t\tif (!res[0]) {\r\n\t\t\t\t\t\t\tthis.$toast('Please log in to little fox first')\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconst web3 = new this.Web3(window.web3.currentProvider)\r\n\t\t\t\t\t\t\t//合约地址测试\r\n\t\t\t\t\t\t\tconst address = \"0x1A3B441D42F733fbC55774456D62081CAd462c3C\"\r\n\t\t\t\t\t\t\t//正式\r\n\t\t\t\t\t\t\t//const address = \"0xAcD1fD491Eb468f93209F2e63cCFdc9926af7731\"\r\n\t\t\t\t\t\t\tconst myContract = new web3.eth.Contract(Abi, address)\r\n\t\t\t\t\t\t\tmyContract.methods.getOffShelfTime(this.detaillist.contract,this.detaillist.tokenId).call().then(\r\n\t\t\t\t\t\t\ttimesTamp => {\r\n\t\t\t\t\t\t\t\t//获取当前时间戳单位毫秒\r\n\t\t\t\t\t\t\t\tvar dataTime = new Date().getTime()\r\n\t\t\t\t\t\t\t\t//当前时间戳与上架时间（秒）相比\r\n\t\t\t\t\t\t\t\tconsole.log('from timesTamp :' + timesTamp, dataTime)\r\n\t\t\t\t\t\t\t\tif (timesTamp * 1000 - dataTime > 0) {\r\n\t\t\t\t\t\t\t\t\tconsole.log(timesTamp * 1000 - dataTime)\r\n\t\t\t\t\t\t\t\t\t//商品未下架获取商品价格\r\n\t\t\t\t\t\t\t\t\t//NFT上架价格\r\n\t\t\t\t\t\t\t\t\tmyContract.methods.getPrices(this.detaillist.contract,this.detaillist.tokenId).call().then(\r\n\t\t\t\t\t\t\t\t\t\tprices => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('from prices :' + prices)\r\n\t\t\t\t\t\t\t\t\t\t\tvar myvalue = BigNumber(prices)\r\n\t\t\t\t\t\t\t\t\t\t\tthis.pageLoading = true\r\n\t\t\t\t\t\t\t\t\t\t\t//var myvalue = BigNumber(web3.utils.toWei(this.detaillist.price.toString(), 'ether'))\r\n\t\t\t\t\t\t\t\t\t\t\t//购买NFT 获取是否授权（授权在上架商品时操作只需操作一次 获取时间戳 获取价格 \r\n\t\t\t\t\t\t\t\t\t\t\tmyContract.methods.buy(this.detaillist.contract,this.detaillist.tokenId).send({\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom: res[0],\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: myvalue//动态获取商品价格\r\n\t\t\t\t\t\t\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('from res :' + res)\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (JSON.stringify(res.status) == 'true') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$toast('Authorization succeeded')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"success\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//刷新页面\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//location.reload()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.pageLoading = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$router.push('me') \r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$toast(res.message)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res.message)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.pageLoading = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t//this.$toast(error.message)\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tconsole.log(timesTamp * 1000 - dataTime)\r\n\t\t\t\t\t\t\t\t\tthis.$toast('The product has been taken off the shelf')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$toast('Please install metamask before the browser can be used.');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdetailNft(userId) {\r\n\t\t\t\tconst params = {\r\n\t\t\t\t\tid: userId,\r\n\t\t\t\t}\r\n\t\t\t\tgetNft(params).then(res => {\r\n\t\t\t\t\tif (res.code == \"200\") {\r\n\t\t\t\t\t\tthis.detaillist = res.result\r\n\t\t\t\t\t\tthis.copyIds = res.result.tokenId\r\n\t\t\t\t\t\tthis.loglist()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$toast(res.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tloglist() {\r\n\t\t\t\tconst params = {\r\n\t\t\t\t\tpageNo: this.page,\r\n\t\t\t\t\tpageSize: this.num,\r\n\t\t\t\t\ttokenId: this.detaillist.tokenId,\r\n\t\t\t\t\tcontract: this.detaillist.contract,\r\n\t\t\t\t}\r\n\t\t\t\tlistLog(params).then(res => {\r\n\t\t\t\t\tif (res.code == \"200\") {\r\n\t\t\t\t\t\tif (this.page == 1) {\r\n\t\t\t\t\t\t\tthis.datalist = res.result.list\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.datalist = this.datalist.concat(res.result.list)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\t\tif (res.result.list.length == 0 || res.result.list.length < 10) {\r\n\t\t\t\t\t\t\tthis.finished = true\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$toast(res.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t}\r\n</script>\r\n<style scoped>\r\n\t.hasdata{\r\n\t\tmargin: 10px auto;\r\n\t}\r\n\t.nodata{\r\n\t\tmargin: 10px auto;\r\n\t\ttext-align: center;\r\n\t}\r\n\t.headerbox {\r\n\t\tposition: fixed;\r\n\t\twidth: 100%;\r\n\t\ttop:0;\r\n\t\tborder-bottom: 10px solid #F7F7F7;\r\n\t}\r\n\t.addurl {\r\n\t\tborder-bottom: 1px solid #333333;\r\n\t}\r\n\r\n\t.contentone {\r\n\t\tborder-bottom: 10px solid #F7F7F7;\r\n\t\tpadding: 20px 16px 10px 16px;\r\n\t\tmargin-top: 45px;\r\n\t}\r\n\r\n\t.onecelll {\r\n\t\theight: 14px;\r\n\t\tfont-size: 14px;\r\n\t\tfont-family: SourceHanSansCN-Regular, SourceHanSansCN;\r\n\t\tfont-weight: 400;\r\n\t\tcolor: #666666;\r\n\t\tline-height: 21px;\r\n\t}\r\n\r\n\t.onecellr {\r\n\t\tfloat: right;\r\n\t\ttext-align: right;\r\n\t\tcolor: #FF5603;\r\n\t\tfont-size: 12px;\r\n\t\twidth: 200px;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t.twocell {\r\n\t\tmargin: 8px 0;\r\n\t}\r\n\r\n\t.twocelll {\r\n\t\tmax-width: 100%;\r\n\t\theight: 20px;\r\n\t\tfont-size: 17px;\r\n\t\tfont-family: SourceHanSansCN-Medium, SourceHanSansCN;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #333333;\r\n\t\t/* overflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap; */\r\n\t\tdisplay: inline-block;\t\r\n\t}\r\n\r\n\t.twocellr {\r\n\t\tfloat: right;\r\n\t\t/* margin-top: 3px; */\r\n\t}\r\n\r\n\t.threecell {\r\n\t\twidth: 100%;\r\n\t}\r\n\t.imgobject {\r\n\t\tobject-fit: cover;\r\n\t\tobject-position: 50% 50%;\r\n\t}\r\n\t.threecell img {\r\n\t\twidth: 100%;\r\n\t\t/* height: 300px; */\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\t.fourcell {\r\n\t\tmargin: 0 auto;\r\n\t\theight: 35px;\r\n\t\tbackground: #FFFFFF;\r\n\t\tfont-size: 12px;\r\n\t\tfont-weight: 400;\r\n\t\tline-height: 35px;\r\n\t\tfont-family: SourceHanSansCN-Regular, SourceHanSansCN;\r\n\t}\r\n\r\n\t.fourcelll {\r\n\t\tdisplay: inline-block;\r\n\t}\r\n\r\n\t.fourcellone {\r\n\t\tcolor: #666666;\r\n\t}\r\n\r\n\t.fourcelltwo {\r\n\t\tmargin-left: 5px;\r\n\t\tcolor: #FF5603;\r\n\t}\r\n\r\n\t.fourcellr {\r\n\t\tcolor: #999999;\r\n\t\tfloat: right;\r\n\t\tdisplay: inline-block;\r\n\t\tfont-size: 10px;\r\n\t}\r\n\r\n\t.contenttwo {\r\n\t\tbackground: #FFFFFF;\r\n\t}\r\n\r\n\t.contenttwoo {\r\n\t\tfont-size: 13px;\r\n\t\tcolor: #000000;\r\n\t\tline-height: 20px;\r\n\t\tpadding: 10px 20px 0 20px;\r\n\t}\r\n\r\n\t.contenttwot {\r\n\t\theight: 50px;\r\n\t\tline-height: 50px;\r\n\t\tdisplay: flex;\r\n\t\tborder-bottom: 0.026667rem solid #D8D8D8;\r\n\t\tpadding: 0px 20px 0 20px;\r\n\t}\r\n\r\n\t.contenttwotl {\r\n\t\twidth: 350px;\r\n\t}\r\n\r\n\t.contenttwotl img {\r\n\t\twidth: 24px;\r\n\t\theight: 24px;\r\n\t\tvertical-align: middle;\r\n\t}\r\n\r\n\t.spantwo {\r\n\t\tfont-size: 20px;\r\n\t\tfont-family: SourceHanSansCN-Medium, SourceHanSansCN;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #F4BB0B;\r\n\t\tvertical-align: middle;\r\n\t\tmargin: 0 5px;\r\n\t}\r\n\r\n\t.spanthree {\r\n\t\tfont-size: 11px;\r\n\t\tfont-family: SourceHanSansCN-Normal, SourceHanSansCN;\r\n\t\tfont-weight: 400;\r\n\t\tcolor: #000000;\r\n\t\tvertical-align: middle;\r\n\t}\r\n\r\n\t.contenttwotr {\r\n\t\tfloat: right;\r\n\t\twidth: 105px;\r\n\t\theight: 27px;\r\n\t\tline-height: 27px;\r\n\t\tbackground: #FADD5C;\r\n\t\tborder-radius: 8px;\r\n\t\tfont-family: SourceHanSansCN-Regular, SourceHanSansCN;\r\n\t\tfont-weight: 400;\r\n\t\tcolor: #000000;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 13px;\r\n\t\tmargin-top: 10px;\r\n\t}\r\n.contenttwotrn{\r\n\tfloat: right;\r\n\twidth: 105px;\r\n\theight: 27px;\r\n\tline-height: 27px;\r\n\tbackground: #CCCCCC;\r\n\tborder-radius: 8px;\r\n\tfont-family: SourceHanSansCN-Regular, SourceHanSansCN;\r\n\tfont-weight: 400;\r\n\tcolor: #FFFFFF;\r\n\ttext-align: center;\r\n\tfont-size: 13px;\r\n\tmargin-top: 10px;\r\n}\r\n\t.mycell {\r\n\t\tbackground-color: #FFFFFF;\r\n\t}\r\n.descriptionbox{\r\n\tpadding: 10px 20px;\r\n\tbackground: #F7F7F7;\r\n\tfont-size: 12px;\r\n\tcolor: #666666;\r\n}\r\n\t.copyadd {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #999999;\r\n\t\twidth: 150px;\r\n\t\ttext-align: right;\r\n\t\tmargin-right: 5px;\r\n\t}\r\n\r\n\t.copyimg {\r\n\t\twidth: 16px;\r\n\t\theight: 16px;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t/deep/ .van-collapse-item__content {\r\n\t\tpadding: 0;\r\n\t}\r\n\r\n\t/deep/.van-cell {\r\n\t\tfont-size: 12px;\r\n\t}\r\n\r\n\t/deep/.van-cell::after {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t/deep/.van-collapse-item--border::after {\r\n\t\tborder-top: none;\r\n\t}\r\n\r\n\t/deep/.van-hairline--top-bottom::after,\r\n\t.van-hairline-unset--top-bottom::after {\r\n\t\tborder-width: 0;\r\n\t}\r\n\r\n\t/deep/.van-nav-bar .van-icon {\r\n\t\tcolor: #000000;\r\n\t}\r\n\r\n\t.van-col {\r\n\t\ttext-align: center;\r\n\t\tfont-size: 11px;\r\n\t\tcolor: #666666;\r\n\t\tmargin-top: 8px;\r\n\t}\r\n\t.loadingbox{\r\n\t\twidth: 100%;\r\n\t\tposition: fixed;\r\n\t\ttop:50%;\r\n\t\ttext-align: center;\r\n\t}\r\n</style>\n"]}]}