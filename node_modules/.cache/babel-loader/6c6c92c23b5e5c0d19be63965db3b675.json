{"remainingRequest":"D:\\project\\dapp\\node_modules\\babel-loader\\lib\\index.js!D:\\project\\dapp\\node_modules\\cache-loader\\dist\\cjs.js??ref--0-0!D:\\project\\dapp\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\project\\dapp\\src\\views\\shopDetail.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\project\\dapp\\src\\views\\shopDetail.vue","mtime":1652173775801},{"path":"D:\\project\\dapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650249328532},{"path":"D:\\project\\dapp\\node_modules\\babel-loader\\lib\\index.js","mtime":1650249335774},{"path":"D:\\project\\dapp\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1650249328532},{"path":"D:\\project\\dapp\\node_modules\\vue-loader\\lib\\index.js","mtime":1650249334419}],"contextDependencies":[],"result":["import \"vant/es/collapse/style\";\nimport _Collapse from \"vant/es/collapse\";\nimport \"vant/es/collapse-item/style\";\nimport _CollapseItem from \"vant/es/collapse-item\";\nimport \"vant/es/cell/style\";\nimport _Cell from \"vant/es/cell\";\nimport \"vant/es/col/style\";\nimport _Col from \"vant/es/col\";\nimport \"vant/es/row/style\";\nimport _Row from \"vant/es/row\";\nimport \"vant/es/nav-bar/style\";\nimport _NavBar from \"vant/es/nav-bar\";\nimport \"vant/es/list/style\";\nimport _List from \"vant/es/list\";\nimport \"vant/es/loading/style\";\nimport _Loading from \"vant/es/loading\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Vue from 'vue';\nimport Abi from \"../json/Abi.js\";\nimport BigNumber from \"bignumber.js\";\nVue.use(_Collapse).use(_CollapseItem).use(_Cell).use(_Col).use(_Row).use(_NavBar).use(_List).use(_Loading);\nimport { listLog, getNft } from \"../api\";\nexport default {\n  data: function data() {\n    return {\n      activeNames: [0],\n      datalist: [],\n      detaillist: [],\n      copyIds: '',\n      page: 1,\n      num: 10,\n      loading: false,\n      finished: false,\n      pageLoading: false,\n      myaddress: sessionStorage.getItem('myAddress')\n    };\n  },\n  created: function created() {\n    this.detailNft(this.$route.query.userId);\n    console.log(this.$route.query.userId, 11);\n  },\n  methods: {\n    onMore: function onMore() {\n      if (this.detaillist != '') {\n        this.page++;\n        this.loglist();\n      }\n    },\n    copyclick: function copyclick(txt) {\n      var _this = this;\n\n      console.log(txt);\n      this.$copyText(txt).then(function () {\n        _this.$toast('Successfully copied to clipboard');\n      }).catch(function () {\n        _this.$toast('Copy failed');\n      });\n    },\n    //跳转他人地址\n    gootheraddress: function gootheraddress(address) {\n      if (address == this.myaddress) {\n        this.$router.push({\n          name: 'me',\n          query: {\n            address: address\n          }\n        });\n      } else {\n        this.$router.push({\n          name: 'otherList',\n          query: {\n            address: address\n          }\n        });\n      }\n    },\n    //购买\n    buyClick: function buyClick() {\n      var _this2 = this;\n\n      if (window.ethereum) {\n        window.ethereum.enable().then(function (res) {\n          if (!res[0]) {\n            _this2.$toast('Please log in to little fox first');\n          } else {\n            var web3 = new _this2.Web3(window.web3.currentProvider); //合约地址\n\n            var address = \"0x1A3B441D42F733fbC55774456D62081CAd462c3C\";\n            var myContract = new web3.eth.Contract(Abi, address);\n            myContract.methods.getOffShelfTime(_this2.detaillist.contract, _this2.detaillist.tokenId).call().then(function (timesTamp) {\n              //获取当前时间戳单位毫秒\n              var dataTime = new Date().getTime(); //当前时间戳与上架时间（秒）相比\n\n              console.log('from timesTamp :' + timesTamp, dataTime);\n\n              if (timesTamp * 1000 - dataTime > 0) {\n                //商品未下架获取商品价格\n                //NFT上架价格\n                myContract.methods.getPrices(_this2.detaillist.contract, _this2.detaillist.tokenId).call().then(function (prices) {\n                  console.log('from prices :' + prices);\n                  var myvalue = BigNumber(prices);\n                  _this2.pageLoading = true; //var myvalue = BigNumber(web3.utils.toWei(this.detaillist.price.toString(), 'ether'))\n                  //购买NFT 获取是否授权（授权在上架商品时操作只需操作一次 获取时间戳 获取价格 \n\n                  myContract.methods.buy(_this2.detaillist.contract, _this2.detaillist.tokenId).send({\n                    from: res[0],\n                    value: myvalue //动态获取商品价格\n\n                  }).then(function (res) {\n                    console.log('from res :' + res);\n\n                    if (JSON.stringify(res.status) == 'true') {\n                      _this2.$toast('Authorization succeeded');\n\n                      console.log(\"success\"); //刷新页面\n                      //location.reload()\n\n                      _this2.pageLoading = false;\n\n                      _this2.$router.push('me');\n                    } else {\n                      _this2.$toast(res.message);\n\n                      console.log(res.message);\n                    }\n                  }).catch(function (error) {\n                    _this2.pageLoading = false;\n\n                    _this2.$toast(error.message);\n                  });\n                });\n              } else {\n                _this2.$toast('The product has been taken off the shelf');\n              }\n            });\n          }\n        });\n      } else {\n        this.$toast('Please install metamask before the browser can be used.');\n      }\n    },\n    detailNft: function detailNft(userId) {\n      var _this3 = this;\n\n      var params = {\n        id: userId\n      };\n      getNft(params).then(function (res) {\n        if (res.code == \"200\") {\n          _this3.detaillist = res.result;\n          _this3.copyIds = res.result.tokenId;\n\n          _this3.loglist();\n        } else {\n          _this3.$toast(res.message);\n        }\n      });\n    },\n    loglist: function loglist() {\n      var _this4 = this;\n\n      var params = {\n        pageNo: this.page,\n        pageSize: this.num,\n        tokenId: this.detaillist.tokenId,\n        contract: this.detaillist.contract\n      };\n      listLog(params).then(function (res) {\n        if (res.code == \"200\") {\n          if (_this4.page == 1) {\n            _this4.datalist = res.result.list;\n          } else {\n            _this4.datalist = _this4.datalist.concat(res.result.list);\n          }\n\n          _this4.loading = false;\n\n          if (res.result.list.length == 0 || res.result.list.length < 10) {\n            _this4.finished = true;\n            return;\n          }\n        } else {\n          _this4.$toast(res.message);\n        }\n      });\n    }\n  }\n};",{"version":3,"sources":["shopDetail.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\r\n\t<div class=\"wrap\">\r\n\t\t<div class=\"headerbox\">\r\n\t\t<van-nav-bar title=\"NFT details\" left-arrow @click-left=\"$router.go(-1)\" />\r\n\t\t</div>\r\n\t\t<div class=\"contentone\">\r\n\t\t\t<div class=\"onecell\"><span class=\"onecelll\">Minted by</span><span\r\n\t\t\t\t\t@click=\"gootheraddress(detaillist.creator)\"\r\n\t\t\t\t\tclass=\"onecellr\">{{detaillist.creator==null?'creator':detaillist.creator | ellipsis}}</span></div>\r\n\t\t\t<div class=\"twocell\"><span class=\"twocelll\">{{detaillist.name==null?'name':detaillist.name}}</span>\r\n\t\t\t<!-- <span class=\"twocellr\">#{{detaillist.tokenId}}</span> -->\r\n\t\t\t</div>\r\n\t\t\t<div class=\"threecell\">\r\n\t\t\t\t<img v-if=\"detaillist.image==null\" src=\"../assets/images/zw.png\" />\r\n\t\t\t\t<img v-else :src=\"detaillist.image\" />\r\n\t\t\t</div>\r\n\t\t\t<div class=\"fourcell\">\r\n\t\t\t\t<div class=\"fourcelll\">\r\n\t\t\t\t\t<span class=\"fourcellone\">Owned by</span>\r\n\t\t\t\t\t<span class=\"fourcelltwo\"\r\n\t\t\t\t\t\t@click=\"gootheraddress(detaillist.owner)\">{{detaillist.owner==null?'detaillistowner':detaillist.owner | ellipsis}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div class=\"fourcellr\">End date {{detaillist.offSheftTime}}</div>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t\t<div class=\"contenttwo\">\r\n\t\t\t<div class=\"contenttwoo\">Current price</div>\r\n\t\t\t<div class=\"contenttwot\">\r\n\t\t\t\t<div class=\"contenttwotl\">\r\n\t\t\t\t\t<span><img src=\"../assets/images/icon1.png\"></span>\r\n\t\t\t\t\t<span class=\"spantwo\">{{detaillist.price}}</span>\r\n\t\t\t\t\t<span class=\"spanthree\">{{`（$${detaillist.uprice}）`}}</span>\r\n\t\t\t\t</div>\r\n\t\t\t\t<div v-if=\"detaillist.owner != myaddress\" class=\"contenttwotr\" @click=\"buyClick\">Buy now</div>\r\n\t\t\t\t<div v-else class=\"contenttwotrn\" >Buy now</div>\r\n\t\t\t</div>\r\n\t\t\t<div>\r\n\t\t\t\t<van-collapse v-model=\"activeNames\">\r\n\t\t\t\t\t<van-collapse-item title=\"Details of the works\" name=\"1\" icon=\"shop-o\" class='mycell'>\r\n\t\t\t\t\t\t<van-cell title=\"Contract address\">\r\n\t\t\t\t\t\t\t<template #right-icon>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\tclass=\"copyadd\">{{detaillist.contract==null?'detaillistcontract':detaillist.contract | ellipsis }}</span>\r\n\t\t\t\t\t\t\t\t<img class=\"copyimg\" @click=\"copyclick(detaillist.contract)\" src=\"../assets/images/copy.png\">\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</van-cell>\r\n\t\t\t\t\t\t<van-cell title=\"Token ID\">\r\n\t\t\t\t\t\t\t<template #right-icon>\r\n\t\t\t\t\t\t\t\t<span\r\n\t\t\t\t\t\t\t\t\tclass=\"copyadd\">{{detaillist.tokenId==null?'detaillisttokenId':detaillist.tokenId | ellipsis }}</span>\r\n\t\t\t\t\t\t\t\t<img class=\"copyimg\" @click=\"copyclick(copyIds)\" src=\"../assets/images/copy.png\">\r\n\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t</van-cell>\r\n\t\t\t\t\t\t<van-cell title=\"Token standard\" value=\"ERC-721\" />\r\n\t\t\t\t\t\t<van-cell title=\"Blockchain\" value=\"BNB\" />\r\n\t\t\t\t\t</van-collapse-item>\r\n\t\t\t\t\t<van-list v-model:loading=\"loading\" :finished=\"finished\" @load=\"onMore\" loading-text=\"Loading\">\r\n\t\t\t\t\t\t<van-collapse-item title=\"Price history\" name=\"2\" icon=\"shop-o\" class='mycell'>\r\n\t\t\t\t\t\t\t<van-row justify=\"space-between\">\r\n\t\t\t\t\t\t\t\t<van-col span=\"6\">Current price</van-col>\r\n\t\t\t\t\t\t\t\t<van-col span=\"6\">Form</van-col>\r\n\t\t\t\t\t\t\t\t<van-col span=\"6\">To</van-col>\r\n\t\t\t\t\t\t\t\t<van-col span=\"6\">Date</van-col>\r\n\t\t\t\t\t\t\t</van-row>\r\n\t\t\t\t\t\t\t<div v-if=\"datalist.length==0\" class=\"nodata\">No deal</div>\r\n\t\t\t\t\t\t\t<div v-else>\r\n\t\t\t\t\t\t\t<van-row justify=\"space-between\" v-for=\"(item,index) in datalist\" :key='index'>\r\n\t\t\t\t\t\t\t\t\t<van-col span=\"6\">{{item.price}}</van-col>\r\n\t\t\t\t\t\t\t\t\t<van-col span=\"6\"><span class=\"addurl\"\r\n\t\t\t\t\t\t\t\t\t\t\t@click=\"gootheraddress(item.buyFrom)\">{{item.buyFrom | ellipsis}}</span></van-col>\r\n\t\t\t\t\t\t\t\t\t<van-col span=\"6\"><span class=\"addurl\"\r\n\t\t\t\t\t\t\t\t\t\t\t@click=\"gootheraddress(item.buyTo)\">{{item.buyTo | ellipsis}}</span></van-col>\r\n\t\t\t\t\t\t\t\t\t<van-col span=\"6\">{{item.createTime | ellipsis}}</van-col>\r\n\t\t\t\t\t\t\t</van-row>\r\n\t\t\t\t\t\t\t</div>\r\n\t\t\t\t\t\t</van-collapse-item>\r\n\t\t\t\t\t</van-list>\r\n\t\t\t\t</van-collapse>\r\n\t\t\t</div>\r\n\t\t</div>\r\n\t<van-loading v-show=\"pageLoading\" type=\"spinner\" size=\"24px\" class=\"loadingbox\"/>\r\n\t</div>\r\n</template>\r\n<script>\r\n\timport Vue from 'vue'\r\n\timport Abi from '../json/Abi.js'\r\n\timport BigNumber from \"bignumber.js\"\r\n\timport {\r\n\t\tCollapse,\r\n\t\tCollapseItem,\r\n\t\tCell,\r\n\t\tCol,\r\n\t\tRow,\r\n\t\tNavBar,\r\n\t\tList,\r\n\t\tLoading\r\n\t} from 'vant'\r\n\tVue.use(Collapse).use(CollapseItem).use(Cell).use(Col).use(Row).use(NavBar).use(List).use(Loading)\r\n\timport {\r\n\t\tlistLog,\r\n\t\tgetNft,\r\n\t} from \"../api\";\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\tactiveNames: [0],\r\n\t\t\t\tdatalist: [],\r\n\t\t\t\tdetaillist: [],\r\n\t\t\t\tcopyIds:'',\r\n\t\t\t\tpage: 1,\r\n\t\t\t\tnum: 10,\r\n\t\t\t\tloading: false,\r\n\t\t\t\tfinished: false,\r\n\t\t\t\tpageLoading:false,\r\n\t\t\t\tmyaddress:sessionStorage.getItem('myAddress'),\r\n\t\t\t}\r\n\t\t},\r\n\t\tcreated() {\r\n\t\t\tthis.detailNft(this.$route.query.userId)\r\n\t\t\tconsole.log(this.$route.query.userId,11)\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tonMore() {\t\r\n\t\t\t\tif(this.detaillist!=''){\r\n\t\t\t\t\tthis.page++\r\n\t\t\t\t\tthis.loglist()\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tcopyclick(txt) {\r\n\t\t\t\tconsole.log(txt)\r\n\t\t\t\tthis.$copyText(txt).then(() => {\r\n\t\t\t\t\tthis.$toast('Successfully copied to clipboard')\r\n\t\t\t\t}).catch(() => {\r\n\t\t\t\t\tthis.$toast('Copy failed')\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\t//跳转他人地址\r\n\t\t\tgootheraddress(address) {\r\n\t\t\t\tif(address==this.myaddress){\r\n\t\t\t\t\tthis.$router.push({\r\n\t\t\t\t\t\tname: 'me',\r\n\t\t\t\t\t\tquery: {\r\n\t\t\t\t\t\t\taddress: address\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}else{\r\n\t\t\t\t\tthis.$router.push({\r\n\t\t\t\t\t\tname: 'otherList',\r\n\t\t\t\t\t\tquery: {\r\n\t\t\t\t\t\t\taddress: address\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\t\t\t\t\r\n\t\t\t},\r\n\t\t\t//购买\r\n\t\t\tbuyClick() {\r\n\t\t\t\tif (window.ethereum) {\r\n\t\t\t\t\twindow.ethereum.enable().then((res) => {\r\n\t\t\t\t\t\tif (!res[0]) {\r\n\t\t\t\t\t\t\tthis.$toast('Please log in to little fox first')\r\n\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\tconst web3 = new this.Web3(window.web3.currentProvider)\r\n\t\t\t\t\t\t\t//合约地址\r\n\t\t\t\t\t\t\tconst address = \"0x1A3B441D42F733fbC55774456D62081CAd462c3C\"\r\n\t\t\t\t\t\t\tconst myContract = new web3.eth.Contract(Abi, address)\r\n\t\t\t\t\t\t\tmyContract.methods.getOffShelfTime(this.detaillist.contract,this.detaillist.tokenId).call().then(\r\n\t\t\t\t\t\t\ttimesTamp => {\r\n\t\t\t\t\t\t\t\t//获取当前时间戳单位毫秒\r\n\t\t\t\t\t\t\t\tvar dataTime = new Date().getTime()\r\n\t\t\t\t\t\t\t\t//当前时间戳与上架时间（秒）相比\r\n\t\t\t\t\t\t\t\tconsole.log('from timesTamp :' + timesTamp, dataTime)\r\n\t\t\t\t\t\t\t\tif (timesTamp * 1000 - dataTime > 0) {\r\n\t\t\t\t\t\t\t\t\t//商品未下架获取商品价格\r\n\t\t\t\t\t\t\t\t\t//NFT上架价格\r\n\t\t\t\t\t\t\t\t\tmyContract.methods.getPrices(this.detaillist.contract,this.detaillist.tokenId).call().then(\r\n\t\t\t\t\t\t\t\t\t\tprices => {\r\n\t\t\t\t\t\t\t\t\t\t\tconsole.log('from prices :' + prices)\r\n\t\t\t\t\t\t\t\t\t\t\tvar myvalue = BigNumber(prices)\r\n\t\t\t\t\t\t\t\t\t\t\tthis.pageLoading = true\r\n\t\t\t\t\t\t\t\t\t\t\t//var myvalue = BigNumber(web3.utils.toWei(this.detaillist.price.toString(), 'ether'))\r\n\t\t\t\t\t\t\t\t\t\t\t//购买NFT 获取是否授权（授权在上架商品时操作只需操作一次 获取时间戳 获取价格 \r\n\t\t\t\t\t\t\t\t\t\t\tmyContract.methods.buy(this.detaillist.contract,this.detaillist.tokenId).send({\r\n\t\t\t\t\t\t\t\t\t\t\t\tfrom: res[0],\r\n\t\t\t\t\t\t\t\t\t\t\t\tvalue: myvalue//动态获取商品价格\r\n\t\t\t\t\t\t\t\t\t\t\t}).then(res => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tconsole.log('from res :' + res)\r\n\t\t\t\t\t\t\t\t\t\t\t\tif (JSON.stringify(res.status) == 'true') {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$toast('Authorization succeeded')\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(\"success\")\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//刷新页面\r\n\t\t\t\t\t\t\t\t\t\t\t\t\t//location.reload()\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.pageLoading = false\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$router.push('me') \r\n\t\t\t\t\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tthis.$toast(res.message)\r\n\t\t\t\t\t\t\t\t\t\t\t\t\tconsole.log(res.message)\r\n\t\t\t\t\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t\t\t\t\t}).catch((error) => {\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.pageLoading = false\r\n\t\t\t\t\t\t\t\t\t\t\t\tthis.$toast(error.message)\r\n\t\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t\t\t\t\r\n\t\t\t\t\t\t\t\t} else {\r\n\t\t\t\t\t\t\t\t\tthis.$toast('The product has been taken off the shelf')\r\n\t\t\t\t\t\t\t\t}\r\n\t\t\t\t\t\t\t})\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.$toast('Please install metamask before the browser can be used.');\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tdetailNft(userId) {\r\n\t\t\t\tconst params = {\r\n\t\t\t\t\tid: userId,\r\n\t\t\t\t}\r\n\t\t\t\tgetNft(params).then(res => {\r\n\t\t\t\t\tif (res.code == \"200\") {\r\n\t\t\t\t\t\tthis.detaillist = res.result\r\n\t\t\t\t\t\tthis.copyIds = res.result.tokenId\r\n\t\t\t\t\t\tthis.loglist()\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$toast(res.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tloglist() {\r\n\t\t\t\tconst params = {\r\n\t\t\t\t\tpageNo: this.page,\r\n\t\t\t\t\tpageSize: this.num,\r\n\t\t\t\t\ttokenId: this.detaillist.tokenId,\r\n\t\t\t\t\tcontract: this.detaillist.contract,\r\n\t\t\t\t}\r\n\t\t\t\tlistLog(params).then(res => {\r\n\t\t\t\t\tif (res.code == \"200\") {\r\n\t\t\t\t\t\tif (this.page == 1) {\r\n\t\t\t\t\t\t\tthis.datalist = res.result.list\r\n\t\t\t\t\t\t}else{\r\n\t\t\t\t\t\t\tthis.datalist = this.datalist.concat(res.result.list)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.loading = false\r\n\t\t\t\t\t\tif (res.result.list.length == 0 || res.result.list.length < 10) {\r\n\t\t\t\t\t\t\tthis.finished = true\r\n\t\t\t\t\t\t\treturn\r\n\t\t\t\t\t\t}\t\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\tthis.$toast(res.message)\r\n\t\t\t\t\t}\r\n\t\t\t\t})\r\n\t\t\t}\r\n\t\t},\r\n\t}\r\n</script>\r\n<style scoped>\r\n\t.nodata{\r\n\t\tmargin: 10px auto;\r\n\t\ttext-align: center;\r\n\t}\r\n\t.headerbox {\r\n\t\tposition: fixed;\r\n\t\twidth: 100%;\r\n\t\ttop:0;\r\n\t\tborder-bottom: 10px solid #F7F7F7;\r\n\t}\r\n\t.addurl {\r\n\t\tborder-bottom: 1px solid #333333;\r\n\t}\r\n\r\n\t.contentone {\r\n\t\tborder-bottom: 10px solid #F7F7F7;\r\n\t\tpadding: 20px 16px 10px 16px;\r\n\t\tmargin-top: 45px;\r\n\t}\r\n\r\n\t.onecelll {\r\n\t\theight: 14px;\r\n\t\tfont-size: 14px;\r\n\t\tfont-family: SourceHanSansCN-Regular, SourceHanSansCN;\r\n\t\tfont-weight: 400;\r\n\t\tcolor: #666666;\r\n\t\tline-height: 21px;\r\n\t}\r\n\r\n\t.onecellr {\r\n\t\tfloat: right;\r\n\t\ttext-align: right;\r\n\t\tcolor: #FF5603;\r\n\t\tfont-size: 12px;\r\n\t\twidth: 200px;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t.twocell {\r\n\t\tmargin: 8px 0;\r\n\t}\r\n\r\n\t.twocelll {\r\n\t\tmax-width: 330px;\r\n\t\tfont-size: 17px;\r\n\t\tfont-family: SourceHanSansCN-Medium, SourceHanSansCN;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #333333;\r\n\t\toverflow: hidden;\r\n\t\ttext-overflow: ellipsis;\r\n\t\twhite-space: nowrap;\r\n\t\tdisplay: inline-block;\t\r\n\t}\r\n\r\n\t.twocellr {\r\n\t\tfloat: right;\r\n\t\t/* margin-top: 3px; */\r\n\t}\r\n\r\n\t.threecell {\r\n\t\twidth: 100%;\r\n\t}\r\n\r\n\t.threecell img {\r\n\t\twidth: 100%;\r\n\t\theight: 300px;\r\n\t\tmargin: 0 auto;\r\n\t}\r\n\r\n\t.fourcell {\r\n\t\tmargin: 0 auto;\r\n\t\theight: 35px;\r\n\t\tbackground: #FFFFFF;\r\n\t\tfont-size: 12px;\r\n\t\tfont-weight: 400;\r\n\t\tline-height: 35px;\r\n\t\tfont-family: SourceHanSansCN-Regular, SourceHanSansCN;\r\n\t}\r\n\r\n\t.fourcelll {\r\n\t\tdisplay: inline-block;\r\n\t}\r\n\r\n\t.fourcellone {\r\n\t\tcolor: #666666;\r\n\t}\r\n\r\n\t.fourcelltwo {\r\n\t\tmargin-left: 5px;\r\n\t\tcolor: #FF5603;\r\n\t}\r\n\r\n\t.fourcellr {\r\n\t\tcolor: #999999;\r\n\t\tfloat: right;\r\n\t\tdisplay: inline-block;\r\n\t\tfont-size: 10px;\r\n\t}\r\n\r\n\t.contenttwo {\r\n\t\tbackground: #FFFFFF;\r\n\t}\r\n\r\n\t.contenttwoo {\r\n\t\tfont-size: 13px;\r\n\t\tcolor: #000000;\r\n\t\tline-height: 20px;\r\n\t\tpadding: 10px 20px 0 20px;\r\n\t}\r\n\r\n\t.contenttwot {\r\n\t\theight: 50px;\r\n\t\tline-height: 50px;\r\n\t\tdisplay: flex;\r\n\t\tborder-bottom: 0.026667rem solid #D8D8D8;\r\n\t\tpadding: 0px 20px 0 20px;\r\n\t}\r\n\r\n\t.contenttwotl {\r\n\t\twidth: 350px;\r\n\t}\r\n\r\n\t.contenttwotl img {\r\n\t\twidth: 24px;\r\n\t\theight: 24px;\r\n\t\tvertical-align: middle;\r\n\t}\r\n\r\n\t.spantwo {\r\n\t\tfont-size: 20px;\r\n\t\tfont-family: SourceHanSansCN-Medium, SourceHanSansCN;\r\n\t\tfont-weight: 500;\r\n\t\tcolor: #F4BB0B;\r\n\t\tvertical-align: middle;\r\n\t\tmargin: 0 5px;\r\n\t}\r\n\r\n\t.spanthree {\r\n\t\tfont-size: 11px;\r\n\t\tfont-family: SourceHanSansCN-Normal, SourceHanSansCN;\r\n\t\tfont-weight: 400;\r\n\t\tcolor: #000000;\r\n\t\tvertical-align: middle;\r\n\t}\r\n\r\n\t.contenttwotr {\r\n\t\tfloat: right;\r\n\t\twidth: 105px;\r\n\t\theight: 27px;\r\n\t\tline-height: 27px;\r\n\t\tbackground: #FADD5C;\r\n\t\tborder-radius: 8px;\r\n\t\tfont-family: SourceHanSansCN-Regular, SourceHanSansCN;\r\n\t\tfont-weight: 400;\r\n\t\tcolor: #000000;\r\n\t\ttext-align: center;\r\n\t\tfont-size: 13px;\r\n\t\tmargin-top: 10px;\r\n\t}\r\n.contenttwotrn{\r\n\tfloat: right;\r\n\twidth: 105px;\r\n\theight: 27px;\r\n\tline-height: 27px;\r\n\tbackground: #CCCCCC;\r\n\tborder-radius: 8px;\r\n\tfont-family: SourceHanSansCN-Regular, SourceHanSansCN;\r\n\tfont-weight: 400;\r\n\tcolor: #FFFFFF;\r\n\ttext-align: center;\r\n\tfont-size: 13px;\r\n\tmargin-top: 10px;\r\n}\r\n\t.mycell {\r\n\t\tbackground-color: #FFFFFF;\r\n\t}\r\n\r\n\t.copyadd {\r\n\t\tfont-size: 12px;\r\n\t\tcolor: #999999;\r\n\t\twidth: 150px;\r\n\t\ttext-align: right;\r\n\t\tmargin-right: 5px;\r\n\t}\r\n\r\n\t.copyimg {\r\n\t\twidth: 16px;\r\n\t\theight: 16px;\r\n\t\tmargin-top: 5px;\r\n\t}\r\n\r\n\t/deep/ .van-collapse-item__content {\r\n\t\tpadding: 0;\r\n\t}\r\n\r\n\t/deep/.van-cell {\r\n\t\tfont-size: 12px;\r\n\t}\r\n\r\n\t/deep/.van-cell::after {\r\n\t\tborder-bottom: none;\r\n\t}\r\n\r\n\t/deep/.van-collapse-item--border::after {\r\n\t\tborder-top: none;\r\n\t}\r\n\r\n\t/deep/.van-hairline--top-bottom::after,\r\n\t.van-hairline-unset--top-bottom::after {\r\n\t\tborder-width: 0;\r\n\t}\r\n\r\n\t/deep/.van-nav-bar .van-icon {\r\n\t\tcolor: #000000;\r\n\t}\r\n\r\n\t.van-col {\r\n\t\ttext-align: center;\r\n\t\tfont-size: 11px;\r\n\t\tcolor: #666666;\r\n\t}\r\n\t.loadingbox{\r\n\t\twidth: 100%;\r\n\t\tposition: fixed;\r\n\t\ttop:50%;\r\n\t\ttext-align: center;\r\n\t}\r\n</style>\n"],"sourceRoot":"src/views"}]}